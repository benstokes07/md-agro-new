<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>OAuth Redirect</title>
  </head>
  <body>
    <script>
      // Required for GitHub OAuth â†’ redirects back to CMS correctly
      function parseQuery(queryString) {
        const query = {};
        const pairs = (queryString[0] === '?' ? queryString.substr(1) : queryString).split('&');
        for (let pair of pairs) {
          const [key, value] = pair.split('=');
          query[decodeURIComponent(key)] = decodeURIComponent(value || '');
        }
        return query;
      }

      const params = parseQuery(window.location.search);
      const origin = params.origin || '/admin/';

      window.opener.postMessage(params, origin);
      window.close();
    </script>
  </body>
</html>
